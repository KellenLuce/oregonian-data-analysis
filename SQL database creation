
CREATE SCHEMA f_proj;


CREATE TABLE f_proj.articles_raw (
	
	headline TEXT,
	author TEXT,
	"label" TEXT,
	date_updated TEXT,
	date_published TEXT,
	share_count TEXT,
	article TEXT

);

COPY f_proj.articles_raw
FROM ''
WITH (FORMAT CSV, HEADER);

COPY f_proj.articles_raw
FROM ''
WITH (FORMAT CSV, HEADER);

CREATE TABLE f_proj.articles_cleaner (
	"id" SERIAL,
	headline TEXT,
	author TEXT,
	author_id INT,
	newspaper TEXT,
	"label" TEXT,
	date_updated TIMESTAMP,
	date_published TIMESTAMP,
	share_count INT,
	article TEXT,
	twitter TEXT
);

/* started cleaning */

BEGIN;

UPDATE f_proj.articles_raw
SET author = regexp_replace(author, 'By ', '')
;

COMMIT;

INSERT INTO f_proj.articles_cleaner (headline) 
	SELECT headline FROM (SELECT DISTINCT * FROM f_proj.articles_raw)
;

